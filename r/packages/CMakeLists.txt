cmake_minimum_required(VERSION 3.10 FATAL_ERROR)
project(RPackages VERSION 1.0.0 LANGUAGES CXX DESCRIPTION "R packages")

set(GNEIS_DAQ gneis.daq)
set(GNEIS_DAQ_SOURCES ${PROJECT_SOURCE_DIR}/${GNEIS_DAQ})
set(GNEIS_DAQ_PACKAGE ${GNEIS_DAQ}.tar.gz)

file(COPY 
	${GNEIS_DAQ_SOURCES} 
	DESTINATION ${PROJECT_BINARY_DIR}
	PATTERN ".*" EXCLUDE
	PATTERN "*.Rproj" EXCLUDE
	)

add_custom_command(
	OUTPUT ${GNEIS_DAQ_PACKAGE}
	COMMAND ${CMAKE_COMMAND} -E tar cfvz ${GNEIS_DAQ_PACKAGE} ${GNEIS_DAQ}
	)
	
add_custom_target(
	GneisDaqPackage ALL
	DEPENDS ${GNEIS_DAQ_PACKAGE} 
	)

if(DEFINED R_PACKAGES_INSTALL_DIR)
	install(
  		FILES ${PROJECT_BINARY_DIR}/${GNEIS_DAQ_PACKAGE}
  		DESTINATION ${R_PACKAGES_INSTALL_DIR}
  	)
endif(DEFINED R_PACKAGES_INSTALL_DIR)
